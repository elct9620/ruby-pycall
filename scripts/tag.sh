#!/usr/bin/env bash

IMAGE_NAME="${REGISTRY}/${REPOSITORY}"
RUBY_MAJOR_VERSION=${RUBY_VERSION%.*}
PYTHON_MAJOR_VERSION=${PYTHON_VERSION%.*}

TAGS="${IMAGE_NAME}:${RUBY_VERSION}-${VARIANT}-py${PYTHON_VERSION}"
TAGS="${TAGS},${IMAGE_NAME}:${RUBY_MAJOR_VERSION}-${VARIANT}-py${PYTHON_MAJOR_VERSION}"

echo $MAJOR_VARIANT
if [ "${MAJOR_VARIANT}" = "yes" ]; then
  TAGS="${TAGS},${IMAGE_NAME}:${RUBY_VERSION}-py${PYTHON_VERSION}"
  TAGS="${TAGS},${IMAGE_NAME}:${RUBY_MAJOR_VERSION}-py${PYTHON_MAJOR_VERSION}"
fi

echo "tags=${TAGS}" >> "$GITHUB_OUTPUT"
